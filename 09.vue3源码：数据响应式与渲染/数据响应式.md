# 数据响应式

[数据侦测](http://shymean.com/article/Vue3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E4%BE%A6%E6%B5%8B)

## 预先准备

- 1. Reflect
- 2.  Proxy
      receiver 修改类似于 通过函数的 apply 修改内部 this 指向一样，不过这里修改的是访问对象<br>

      2. 使用时注意
         - 2.1. set 方法应该返回一个布尔值，在严格模式下，如果 set 方法返回 falsish(包括 undefined、false 等)，会抛出异常，这些细节比较麻烦，可以通过 Reflect 来处理
         - 2.2. 如果代理对象是数组，当调用 push、pop 等方法时，不仅会改变数组元素，也会改变 length 等属性，此时如果代理了 set，则会被触发多次。
      3. 存在的缺陷
         - 3.1. 代理数组时可能存在多次触发 trap 的情况，需要实现去重
         - 3.2. 嵌套对象需要手动转换为 Proxy，可以通过递归实现

## 流程

- 在渲染视图时，**render 方法**会通过 `get` 触发 `track`，然后将 `activeEffect` 添加到数据属性的依赖列表中，这样就完成了依赖收集。
